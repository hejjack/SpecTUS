command: ../predict.py --checkpoint ../checkpoints/finetune_clean/sleek-cloud-581_9M_448+296k/checkpoint-294952
  --output-folder predictions --config-file configs/predict_swgdrug_beam50.yaml
cuda_visible_devices: '2'
dataloader:
  batch_size: 1
  num_workers: 1
dataset:
  data_path: data/extra_libraries/SWGDRUG_3/SWGDRUG_3_noD.jsonl
  data_split: all
  dataset_name: SWGDRUG
general:
  additional_naming_info: beam50
  device: cuda
generation_args:
  do_sample: false
  length_penalty: 1.0
  max_length: 200
  num_beams: 50
  num_return_sequences: 50
  penalty_alpha: null
  temperature: null
  top_k: null
  top_p: null
preprocess_args:
  inference_mode: true
  log_base: 1.28
  log_shift: 29
  max_cumsum: null
  max_mol_repr_len: 100
  max_mz: 500
  max_num_peaks: 300
  mol_repr: smiles
  restrict_intensities: false
  source_token: <nist>
start_loading_time: 12/12/2024 15:08:23
tokenizer_path: tokenizer/tokenizer_mf10M.model
finished_time_utc: 13/12/2024 01:50:52
generation_time: '10:42:16'
wall_time_utc: '10:42:28'
evaluation_0:
    average_num_of_predictions: '36.50243902439024'
    eval_config:
        do_db_search: false
        filtering_args:
            max_mol_repr_len: 100
            max_mz: 500
            max_num_peaks: 300
            mol_repr: smiles
        fingerprint_type: morgan
        fp_simil_function: tanimoto
        on_the_fly: true
        save_best_predictions: true
        threshold: 0.85
    eval_time: 00:00:16
    formula_stats:
        num_all_correct_formulas: 6732 / 59864
        num_at_least_one_correct_formula: '1455'
        num_correct_formulas_at_best_prob: '892'
        num_correct_formulas_at_best_simil: '1216'
        rate_of_all_correct_formulas: '0.11245489776827476'
        rate_of_at_least_one_correct_formula: '0.8871951219512195'
        rate_of_correct_formulas_at_best_prob: '0.5439024390243903'
        rate_of_correct_formulas_at_best_simil: '0.7414634146341463'
    hit_at_k_prob: '[(1, 0.29085365853658535), (2, 0.3926829268292683), (3, 0.4371951219512195),
        (4, 0.4658536585365854), (5, 0.4920731707317073), (6, 0.5140243902439025),
        (7, 0.5310975609756098), (8, 0.5463414634146342), (9, 0.5628048780487804),
        (10, 0.5713414634146341), (11, 0.5798780487804878), (12, 0.5871951219512195),
        (13, 0.5926829268292683), (14, 0.6024390243902439), (15, 0.6067073170731707),
        (16, 0.6097560975609756), (17, 0.6176829268292683), (18, 0.6219512195121951),
        (19, 0.623780487804878), (20, 0.625), (21, 0.6280487804878049), (22, 0.6298780487804878),
        (23, 0.6310975609756098), (24, 0.6341463414634146), (25, 0.6359756097560976),
        (26, 0.6390243902439025), (28, 0.6420731707317073), (29, 0.6432926829268293),
        (30, 0.6463414634146342), (31, 0.6475609756097561), (32, 0.6487804878048781)]'
    labels_path: data/extra_libraries/SWGDRUG_3/SWGDRUG_3_noD.jsonl
    molecular_weight_stats:
        mean_absolute_mw_difference_best_prob: '10.947778873218349'
        mean_absolute_mw_difference_best_simil: '8.830375642287807'
        mean_relative_mw_difference_best_prob: 3.33%
        mean_relative_mw_difference_best_simil: 3.02%
        rate_of_exact_mw_prob: '0.5323170731707317'
        rate_of_exact_mw_simil: '0.7323170731707317'
        rate_of_exact_nominal_mw_prob: '0.5682926829268292'
        rate_of_exact_nominal_mw_simil: '0.7481707317073171'
        rate_of_mw_difference_less_than_1_best_prob: '0.5920731707317073'
        rate_of_mw_difference_less_than_1_best_simil: '0.7573170731707317'
    num_datapoints_tested: '1640'
    num_empty_preds: '0'
    num_predictions_at_k_counter: '[1640, 1633, 1626, 1618, 1606, 1602, 1596, 1589,
        1584, 1573, 1560, 1553, 1545, 1536, 1529, 1513, 1500, 1487, 1478, 1453, 1437,
        1417, 1400, 1371, 1345, 1328, 1304, 1275, 1251, 1227, 1197, 1165, 1137, 1107,
        1074, 1028, 997, 944, 895, 850, 800, 757, 696, 624, 555, 474, 386, 300, 201,
        101]'
    precise_preds_stats:
        num_precise_preds_probsort: '474'
        num_precise_preds_similsort: '1060'
        rate_of_precise_preds_probsort: '0.2890243902439024'
        rate_of_precise_preds_similsort: '0.6463414634146342'
    simil_1_hits:
        counter_multiple_hits: dict_items([(1, 1039), (4, 2), (3, 5), (2, 18)])
        num_1_hits_as_first_probsort: '477'
        num_1_hits_as_first_similsort: '1064'
        num_fp_simil_fail_prob: '3'
        num_fp_simil_fail_simil: '4'
        rate_of_1_hits_as_first_probsort: '0.29085365853658535'
        rate_of_1_hits_as_first_similsort: '0.6487804878048781'
    start_time_utc: 14/12/2024 16:59:08
    threshold_stats:
        num_better_than_threshold_probsort: '516'
        num_better_than_threshold_similsort: '1093'
        rate_of_better_than_threshold_probsort: '0.3146341463414634'
        rate_of_better_than_threshold_similsort: '0.6664634146341464'
        threshold: '0.85'
    topk_probsort: '[0.6600199596162992, 0.5578354800258619, 0.5171520123844146, 0.4975890697544153,
        0.4814312006340128, 0.4720935130920531, 0.46039331086623003, 0.45224591187738317,
        0.4482528556063799, 0.44759418793155825, 0.4370718201103929, 0.4336926694802825,
        0.4285520964764981, 0.431942709489373, 0.4237216055632597, 0.42157790951379204,
        0.42962303526974005, 0.41956474520039705, 0.4188745329092816, 0.41381880860219317,
        0.4072244971430416, 0.4106645471178505, 0.4042125618285974, 0.4054570718250452,
        0.3995816917739196, 0.4049682961876127, 0.39787800239251514, 0.4004904660527412,
        0.3915831919657376, 0.3870432415118486, 0.3823448660730249, 0.38727533235776695,
        0.38194022597047667, 0.38135724225845924, 0.3764909225740358, 0.37686887532614477,
        0.37436764632036157, 0.3706012195423552, 0.3707104988222344, 0.3647551457290026,
        0.3664341759719825, 0.36493150232304317, 0.35365643905952004, 0.3560457473144667,
        0.34425007863837953, 0.351307692005161, 0.34494884935699793, 0.32872345322576996,
        0.3303242533857972, 0.3189307953477923]'
    topk_similsort: '[0.8607288157484166, 0.6971494395277996, 0.635682322510066, 0.5970507823861272,
        0.5687019618905952, 0.5474033197097502, 0.5294217685904788, 0.5141124328990662,
        0.4990930688176629, 0.4875335518250128, 0.47650223945296166, 0.46545506545859494,
        0.45501880411596163, 0.4458944777077303, 0.4368586053239005, 0.4296545424432554,
        0.42200840128710543, 0.41432677700688314, 0.4053738773639495, 0.39899460990362967,
        0.3912851906784109, 0.3847559229753068, 0.37823439122854524, 0.3721005555715007,
        0.36614881366429536, 0.35982388733761844, 0.3539670361744933, 0.34838608214162015,
        0.3429490843220777, 0.33736651785550575, 0.3317647971212052, 0.3263963546621361,
        0.32143814193412373, 0.3155141576466452, 0.3108621791908508, 0.30548294110230384,
        0.2987267656040336, 0.2936242792331019, 0.289594920463208, 0.28447549797119537,
        0.28014629826960785, 0.2739032866484615, 0.26601405729975514, 0.2583219702500314,
        0.2504658364082548, 0.24283635496640757, 0.23615506649822193, 0.22963061197933468,
        0.2172684929029615, 0.20181639556883219]'
evaluation_1:
    average_num_of_predictions: '36.50243902439024'
    eval_config:
        do_db_search: false
        filtering_args:
            max_mol_repr_len: 100
            max_mz: 500
            max_num_peaks: 300
            mol_repr: smiles
        fingerprint_type: morgan
        fp_simil_function: tanimoto
        on_the_fly: true
        save_best_predictions: true
        threshold: 0.85
    eval_time: 00:00:16
    formula_stats:
        num_all_correct_formulas: 6732 / 59864
        num_at_least_one_correct_formula: '1455'
        num_correct_formulas_at_best_prob: '892'
        num_correct_formulas_at_best_simil: '1216'
        rate_of_all_correct_formulas: '0.11245489776827476'
        rate_of_at_least_one_correct_formula: '0.8871951219512195'
        rate_of_correct_formulas_at_best_prob: '0.5439024390243903'
        rate_of_correct_formulas_at_best_simil: '0.7414634146341463'
    hit_at_k_prob: '[(1, 0.29085365853658535), (2, 0.3926829268292683), (3, 0.4371951219512195),
        (4, 0.4658536585365854), (5, 0.4920731707317073), (6, 0.5140243902439025),
        (7, 0.5310975609756098), (8, 0.5463414634146342), (9, 0.5628048780487804),
        (10, 0.5713414634146341), (11, 0.5798780487804878), (12, 0.5871951219512195),
        (13, 0.5926829268292683), (14, 0.6024390243902439), (15, 0.6067073170731707),
        (16, 0.6097560975609756), (17, 0.6176829268292683), (18, 0.6219512195121951),
        (19, 0.623780487804878), (20, 0.625), (21, 0.6280487804878049), (22, 0.6298780487804878),
        (23, 0.6310975609756098), (24, 0.6341463414634146), (25, 0.6359756097560976),
        (26, 0.6390243902439025), (28, 0.6420731707317073), (29, 0.6432926829268293),
        (30, 0.6463414634146342), (31, 0.6475609756097561), (32, 0.6487804878048781)]'
    labels_path: data/extra_libraries/SWGDRUG_3/SWGDRUG_3_noD.jsonl
    molecular_weight_stats:
        mean_absolute_mw_difference_best_prob: '10.947778873218349'
        mean_absolute_mw_difference_best_simil: '8.830375642287807'
        mean_relative_mw_difference_best_prob: 3.33%
        mean_relative_mw_difference_best_simil: 3.02%
        rate_of_exact_mw_prob: '0.5323170731707317'
        rate_of_exact_mw_simil: '0.7323170731707317'
        rate_of_exact_nominal_mw_prob: '0.5682926829268292'
        rate_of_exact_nominal_mw_simil: '0.7481707317073171'
        rate_of_mw_difference_less_than_1_best_prob: '0.5920731707317073'
        rate_of_mw_difference_less_than_1_best_simil: '0.7573170731707317'
    num_datapoints_tested: '1640'
    num_empty_preds: '0'
    num_predictions_at_k_counter: '[1640, 1633, 1626, 1618, 1606, 1602, 1596, 1589,
        1584, 1573, 1560, 1553, 1545, 1536, 1529, 1513, 1500, 1487, 1478, 1453, 1437,
        1417, 1400, 1371, 1345, 1328, 1304, 1275, 1251, 1227, 1197, 1165, 1137, 1107,
        1074, 1028, 997, 944, 895, 850, 800, 757, 696, 624, 555, 474, 386, 300, 201,
        101]'
    precise_preds_stats:
        num_precise_preds_probsort: '474'
        num_precise_preds_similsort: '1060'
        rate_of_precise_preds_probsort: '0.2890243902439024'
        rate_of_precise_preds_similsort: '0.6463414634146342'
    simil_1_hits:
        counter_multiple_hits: dict_items([(1, 1039), (4, 2), (3, 5), (2, 18)])
        num_1_hits_as_first_probsort: '477'
        num_1_hits_as_first_similsort: '1064'
        num_fp_simil_fail_prob: '3'
        num_fp_simil_fail_simil: '4'
        rate_of_1_hits_as_first_probsort: '0.29085365853658535'
        rate_of_1_hits_as_first_similsort: '0.6487804878048781'
    start_time_utc: 14/12/2024 16:59:38
    threshold_stats:
        num_better_than_threshold_probsort: '516'
        num_better_than_threshold_similsort: '1093'
        rate_of_better_than_threshold_probsort: '0.3146341463414634'
        rate_of_better_than_threshold_similsort: '0.6664634146341464'
        threshold: '0.85'
    topk_probsort: '[0.6600199596162992, 0.5578354800258619, 0.5171520123844146, 0.4975890697544153,
        0.4814312006340128, 0.4720935130920531, 0.46039331086623003, 0.45224591187738317,
        0.4482528556063799, 0.44759418793155825, 0.4370718201103929, 0.4336926694802825,
        0.4285520964764981, 0.431942709489373, 0.4237216055632597, 0.42157790951379204,
        0.42962303526974005, 0.41956474520039705, 0.4188745329092816, 0.41381880860219317,
        0.4072244971430416, 0.4106645471178505, 0.4042125618285974, 0.4054570718250452,
        0.3995816917739196, 0.4049682961876127, 0.39787800239251514, 0.4004904660527412,
        0.3915831919657376, 0.3870432415118486, 0.3823448660730249, 0.38727533235776695,
        0.38194022597047667, 0.38135724225845924, 0.3764909225740358, 0.37686887532614477,
        0.37436764632036157, 0.3706012195423552, 0.3707104988222344, 0.3647551457290026,
        0.3664341759719825, 0.36493150232304317, 0.35365643905952004, 0.3560457473144667,
        0.34425007863837953, 0.351307692005161, 0.34494884935699793, 0.32872345322576996,
        0.3303242533857972, 0.3189307953477923]'
    topk_similsort: '[0.8607288157484166, 0.6971494395277996, 0.635682322510066, 0.5970507823861272,
        0.5687019618905952, 0.5474033197097502, 0.5294217685904788, 0.5141124328990662,
        0.4990930688176629, 0.4875335518250128, 0.47650223945296166, 0.46545506545859494,
        0.45501880411596163, 0.4458944777077303, 0.4368586053239005, 0.4296545424432554,
        0.42200840128710543, 0.41432677700688314, 0.4053738773639495, 0.39899460990362967,
        0.3912851906784109, 0.3847559229753068, 0.37823439122854524, 0.3721005555715007,
        0.36614881366429536, 0.35982388733761844, 0.3539670361744933, 0.34838608214162015,
        0.3429490843220777, 0.33736651785550575, 0.3317647971212052, 0.3263963546621361,
        0.32143814193412373, 0.3155141576466452, 0.3108621791908508, 0.30548294110230384,
        0.2987267656040336, 0.2936242792331019, 0.289594920463208, 0.28447549797119537,
        0.28014629826960785, 0.2739032866484615, 0.26601405729975514, 0.2583219702500314,
        0.2504658364082548, 0.24283635496640757, 0.23615506649822193, 0.22963061197933468,
        0.2172684929029615, 0.20181639556883219]'

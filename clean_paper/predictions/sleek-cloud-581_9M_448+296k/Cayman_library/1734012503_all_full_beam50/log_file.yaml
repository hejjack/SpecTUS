command: ../predict.py --checkpoint ../checkpoints/finetune_clean/sleek-cloud-581_9M_448+296k/checkpoint-294952
  --output-folder predictions --config-file configs/predict_cayman_beam50.yaml
cuda_visible_devices: '2'
dataloader:
  batch_size: 1
  num_workers: 1
dataset:
  data_path: data/extra_libraries/Cayman_library/Cayman_library_noD.jsonl
  data_split: all
  dataset_name: Cayman_library
general:
  additional_naming_info: beam50
  device: cuda
generation_args:
  do_sample: false
  length_penalty: 1.0
  max_length: 200
  num_beams: 50
  num_return_sequences: 50
  penalty_alpha: null
  temperature: null
  top_k: null
  top_p: null
preprocess_args:
  inference_mode: true
  log_base: 1.28
  log_shift: 29
  max_cumsum: null
  max_mol_repr_len: 100
  max_mz: 500
  max_num_peaks: 300
  mol_repr: smiles
  restrict_intensities: false
  source_token: <nist>
start_loading_time: 12/12/2024 15:08:23
tokenizer_path: tokenizer/tokenizer_mf10M.model
finished_time_utc: 12/12/2024 20:15:29
generation_time: 05:07:03
wall_time_utc: 05:07:06
evaluation_0:
    average_num_of_predictions: '40.059701492537314'
    eval_config:
        do_db_search: false
        filtering_args:
            max_mol_repr_len: 100
            max_mz: 500
            max_num_peaks: 300
            mol_repr: smiles
        fingerprint_type: morgan
        fp_simil_function: tanimoto
        on_the_fly: true
        save_best_predictions: true
        threshold: 0.85
    eval_time: 00:00:07
    formula_stats:
        num_all_correct_formulas: 1502 / 18788
        num_at_least_one_correct_formula: '321'
        num_correct_formulas_at_best_prob: '191'
        num_correct_formulas_at_best_simil: '258'
        rate_of_all_correct_formulas: '0.07994464551841601'
        rate_of_at_least_one_correct_formula: '0.6844349680170576'
        rate_of_correct_formulas_at_best_prob: '0.4072494669509595'
        rate_of_correct_formulas_at_best_simil: '0.5501066098081023'
    hit_at_k_prob: '[(1, 0.18550106609808104), (2, 0.26865671641791045), (3, 0.31769722814498935),
        (4, 0.326226012793177), (5, 0.35607675906183367), (6, 0.373134328358209),
        (7, 0.3859275053304904), (8, 0.39445628997867804), (9, 0.40298507462686567),
        (10, 0.4051172707889126), (11, 0.4115138592750533), (12, 0.42217484008528783),
        (14, 0.42857142857142855), (15, 0.43283582089552236), (16, 0.43923240938166314),
        (17, 0.44136460554371004), (18, 0.44349680170575695), (19, 0.44776119402985076),
        (20, 0.44989339019189767), (25, 0.4541577825159915), (26, 0.4584221748400853),
        (27, 0.464818763326226), (29, 0.4669509594882729), (38, 0.4690831556503198)]'
    labels_path: data/extra_libraries/Cayman_library/Cayman_library_noD.jsonl
    molecular_weight_stats:
        mean_absolute_mw_difference_best_prob: '31.949848194793184'
        mean_absolute_mw_difference_best_simil: '29.493778918563326'
        mean_relative_mw_difference_best_prob: 11.30%
        mean_relative_mw_difference_best_simil: 10.43%
        rate_of_exact_mw_prob: '0.39872068230277186'
        rate_of_exact_mw_simil: '0.5287846481876333'
        rate_of_exact_nominal_mw_prob: '0.44136460554371004'
        rate_of_exact_nominal_mw_simil: '0.5501066098081023'
        rate_of_mw_difference_less_than_1_best_prob: '0.4605543710021322'
        rate_of_mw_difference_less_than_1_best_simil: '0.5565031982942431'
    num_datapoints_tested: '469'
    num_empty_preds: '0'
    num_predictions_at_k_counter: '[469, 467, 467, 467, 467, 466, 466, 464, 462, 462,
        460, 457, 454, 451, 447, 446, 444, 442, 438, 435, 433, 428, 427, 423, 418,
        416, 415, 408, 405, 397, 389, 382, 370, 367, 357, 348, 338, 333, 321, 313,
        301, 287, 271, 247, 225, 195, 165, 136, 95, 47]'
    precise_preds_stats:
        num_precise_preds_probsort: '87'
        num_precise_preds_similsort: '218'
        rate_of_precise_preds_probsort: '0.18550106609808104'
        rate_of_precise_preds_similsort: '0.464818763326226'
    simil_1_hits:
        counter_multiple_hits: dict_items([(1, 212), (3, 2), (2, 6)])
        num_1_hits_as_first_probsort: '87'
        num_1_hits_as_first_similsort: '220'
        num_fp_simil_fail_prob: '0'
        num_fp_simil_fail_simil: '2'
        rate_of_1_hits_as_first_probsort: '0.18550106609808104'
        rate_of_1_hits_as_first_similsort: '0.4690831556503198'
    start_time_utc: 14/12/2024 16:56:38
    threshold_stats:
        num_better_than_threshold_probsort: '106'
        num_better_than_threshold_similsort: '239'
        rate_of_better_than_threshold_probsort: '0.2260127931769723'
        rate_of_better_than_threshold_similsort: '0.509594882729211'
        threshold: '0.85'
    topk_probsort: '[0.6083289440782758, 0.5406792289355601, 0.5153560575726941, 0.48177045330115104,
        0.48857860540063536, 0.4719031838526756, 0.4576236919997998, 0.4610737393525,
        0.44441657264040596, 0.43984368037812716, 0.43357383046858067, 0.4462590049299988,
        0.4315954119928563, 0.42572757696334573, 0.43052752983763176, 0.43397064437819394,
        0.42639337863320936, 0.41767958516184617, 0.4127375363720047, 0.4213763908866397,
        0.4096954704636755, 0.41301248277117203, 0.4072764181830788, 0.3980793175754518,
        0.3934880283060586, 0.3983627079391693, 0.39614966746519864, 0.4025982799215135,
        0.39920724482459147, 0.3947240375855652, 0.3930072682978055, 0.37278675179882576,
        0.37668675705779064, 0.38511628447306046, 0.3835019723787029, 0.3726453312921889,
        0.36952213075607115, 0.3654352434778579, 0.36420040060892006, 0.35866714248660436,
        0.36063180827732244, 0.35136752441773994, 0.35865309722348926, 0.35354223990102635,
        0.34872286875977376, 0.35140471789431477, 0.32524534900491203, 0.31143740447628493,
        0.3121866278134141, 0.2813837219138076]'
    topk_similsort: '[0.7801495128277657, 0.6651929753045323, 0.6165588095719797,
        0.5847381963556023, 0.5598523723599046, 0.540385252515184, 0.5253402877119993,
        0.5120279794700754, 0.4994967367442374, 0.4869028828944406, 0.4774850434858407,
        0.46929677231068095, 0.46089348008873016, 0.4525954100437137, 0.445293222806719,
        0.43763491212065564, 0.43074904844884265, 0.4238309443344969, 0.41728133092565356,
        0.40971543486506473, 0.40343974994195203, 0.3979931212303004, 0.39187162742094334,
        0.38559472702470005, 0.3797475843934606, 0.37211771974683877, 0.3646655932697151,
        0.36042867813160073, 0.35387614846426807, 0.34909899865820915, 0.34280287680160254,
        0.33783249143673216, 0.33344267712658915, 0.327246720587515, 0.32210929985855596,
        0.31515757855212456, 0.3089458272955546, 0.3010078973792362, 0.2979393468354456,
        0.29070238330583204, 0.28321080368741547, 0.2774662886955399, 0.27166192279669155,
        0.2659315394994075, 0.25775713194329225, 0.25156671681853565, 0.24026854377080697,
        0.23238950366168082, 0.22735555239721722, 0.19191352298292716]'
evaluation_1:
    average_num_of_predictions: '40.059701492537314'
    eval_config:
        do_db_search: false
        filtering_args:
            max_mol_repr_len: 100
            max_mz: 500
            max_num_peaks: 300
            mol_repr: smiles
        fingerprint_type: morgan
        fp_simil_function: tanimoto
        on_the_fly: true
        save_best_predictions: true
        threshold: 0.85
    eval_time: 00:00:07
    formula_stats:
        num_all_correct_formulas: 1502 / 18788
        num_at_least_one_correct_formula: '321'
        num_correct_formulas_at_best_prob: '191'
        num_correct_formulas_at_best_simil: '258'
        rate_of_all_correct_formulas: '0.07994464551841601'
        rate_of_at_least_one_correct_formula: '0.6844349680170576'
        rate_of_correct_formulas_at_best_prob: '0.4072494669509595'
        rate_of_correct_formulas_at_best_simil: '0.5501066098081023'
    hit_at_k_prob: '[(1, 0.18550106609808104), (2, 0.26865671641791045), (3, 0.31769722814498935),
        (4, 0.326226012793177), (5, 0.35607675906183367), (6, 0.373134328358209),
        (7, 0.3859275053304904), (8, 0.39445628997867804), (9, 0.40298507462686567),
        (10, 0.4051172707889126), (11, 0.4115138592750533), (12, 0.42217484008528783),
        (14, 0.42857142857142855), (15, 0.43283582089552236), (16, 0.43923240938166314),
        (17, 0.44136460554371004), (18, 0.44349680170575695), (19, 0.44776119402985076),
        (20, 0.44989339019189767), (25, 0.4541577825159915), (26, 0.4584221748400853),
        (27, 0.464818763326226), (29, 0.4669509594882729), (38, 0.4690831556503198)]'
    labels_path: data/extra_libraries/Cayman_library/Cayman_library_noD.jsonl
    molecular_weight_stats:
        mean_absolute_mw_difference_best_prob: '31.949848194793184'
        mean_absolute_mw_difference_best_simil: '29.493778918563326'
        mean_relative_mw_difference_best_prob: 11.30%
        mean_relative_mw_difference_best_simil: 10.43%
        rate_of_exact_mw_prob: '0.39872068230277186'
        rate_of_exact_mw_simil: '0.5287846481876333'
        rate_of_exact_nominal_mw_prob: '0.44136460554371004'
        rate_of_exact_nominal_mw_simil: '0.5501066098081023'
        rate_of_mw_difference_less_than_1_best_prob: '0.4605543710021322'
        rate_of_mw_difference_less_than_1_best_simil: '0.5565031982942431'
    num_datapoints_tested: '469'
    num_empty_preds: '0'
    num_predictions_at_k_counter: '[469, 467, 467, 467, 467, 466, 466, 464, 462, 462,
        460, 457, 454, 451, 447, 446, 444, 442, 438, 435, 433, 428, 427, 423, 418,
        416, 415, 408, 405, 397, 389, 382, 370, 367, 357, 348, 338, 333, 321, 313,
        301, 287, 271, 247, 225, 195, 165, 136, 95, 47]'
    precise_preds_stats:
        num_precise_preds_probsort: '87'
        num_precise_preds_similsort: '218'
        rate_of_precise_preds_probsort: '0.18550106609808104'
        rate_of_precise_preds_similsort: '0.464818763326226'
    simil_1_hits:
        counter_multiple_hits: dict_items([(1, 212), (3, 2), (2, 6)])
        num_1_hits_as_first_probsort: '87'
        num_1_hits_as_first_similsort: '220'
        num_fp_simil_fail_prob: '0'
        num_fp_simil_fail_simil: '2'
        rate_of_1_hits_as_first_probsort: '0.18550106609808104'
        rate_of_1_hits_as_first_similsort: '0.4690831556503198'
    start_time_utc: 14/12/2024 16:56:56
    threshold_stats:
        num_better_than_threshold_probsort: '106'
        num_better_than_threshold_similsort: '239'
        rate_of_better_than_threshold_probsort: '0.2260127931769723'
        rate_of_better_than_threshold_similsort: '0.509594882729211'
        threshold: '0.85'
    topk_probsort: '[0.6083289440782758, 0.5406792289355601, 0.5153560575726941, 0.48177045330115104,
        0.48857860540063536, 0.4719031838526756, 0.4576236919997998, 0.4610737393525,
        0.44441657264040596, 0.43984368037812716, 0.43357383046858067, 0.4462590049299988,
        0.4315954119928563, 0.42572757696334573, 0.43052752983763176, 0.43397064437819394,
        0.42639337863320936, 0.41767958516184617, 0.4127375363720047, 0.4213763908866397,
        0.4096954704636755, 0.41301248277117203, 0.4072764181830788, 0.3980793175754518,
        0.3934880283060586, 0.3983627079391693, 0.39614966746519864, 0.4025982799215135,
        0.39920724482459147, 0.3947240375855652, 0.3930072682978055, 0.37278675179882576,
        0.37668675705779064, 0.38511628447306046, 0.3835019723787029, 0.3726453312921889,
        0.36952213075607115, 0.3654352434778579, 0.36420040060892006, 0.35866714248660436,
        0.36063180827732244, 0.35136752441773994, 0.35865309722348926, 0.35354223990102635,
        0.34872286875977376, 0.35140471789431477, 0.32524534900491203, 0.31143740447628493,
        0.3121866278134141, 0.2813837219138076]'
    topk_similsort: '[0.7801495128277657, 0.6651929753045323, 0.6165588095719797,
        0.5847381963556023, 0.5598523723599046, 0.540385252515184, 0.5253402877119993,
        0.5120279794700754, 0.4994967367442374, 0.4869028828944406, 0.4774850434858407,
        0.46929677231068095, 0.46089348008873016, 0.4525954100437137, 0.445293222806719,
        0.43763491212065564, 0.43074904844884265, 0.4238309443344969, 0.41728133092565356,
        0.40971543486506473, 0.40343974994195203, 0.3979931212303004, 0.39187162742094334,
        0.38559472702470005, 0.3797475843934606, 0.37211771974683877, 0.3646655932697151,
        0.36042867813160073, 0.35387614846426807, 0.34909899865820915, 0.34280287680160254,
        0.33783249143673216, 0.33344267712658915, 0.327246720587515, 0.32210929985855596,
        0.31515757855212456, 0.3089458272955546, 0.3010078973792362, 0.2979393468354456,
        0.29070238330583204, 0.28321080368741547, 0.2774662886955399, 0.27166192279669155,
        0.2659315394994075, 0.25775713194329225, 0.25156671681853565, 0.24026854377080697,
        0.23238950366168082, 0.22735555239721722, 0.19191352298292716]'
evaluation_2:
    average_num_of_predictions: '40.059701492537314'
    eval_config:
        do_db_search: false
        filtering_args:
            max_mol_repr_len: 100
            max_mz: 500
            max_num_peaks: 300
            mol_repr: smiles
        fingerprint_type: morgan
        fp_simil_function: tanimoto
        on_the_fly: true
        save_best_predictions: true
        threshold: 0.85
    eval_time: 00:00:08
    formula_stats:
        num_all_correct_formulas: 1502 / 18788
        num_at_least_one_correct_formula: '321'
        num_correct_formulas_at_best_prob: '191'
        num_correct_formulas_at_best_simil: '258'
        rate_of_all_correct_formulas: '0.07994464551841601'
        rate_of_at_least_one_correct_formula: '0.6844349680170576'
        rate_of_correct_formulas_at_best_prob: '0.4072494669509595'
        rate_of_correct_formulas_at_best_simil: '0.5501066098081023'
    hit_at_k_prob: '[(1, 0.18550106609808104), (2, 0.26865671641791045), (3, 0.31769722814498935),
        (4, 0.326226012793177), (5, 0.35607675906183367), (6, 0.373134328358209),
        (7, 0.3859275053304904), (8, 0.39445628997867804), (9, 0.40298507462686567),
        (10, 0.4051172707889126), (11, 0.4115138592750533), (12, 0.42217484008528783),
        (14, 0.42857142857142855), (15, 0.43283582089552236), (16, 0.43923240938166314),
        (17, 0.44136460554371004), (18, 0.44349680170575695), (19, 0.44776119402985076),
        (20, 0.44989339019189767), (25, 0.4541577825159915), (26, 0.4584221748400853),
        (27, 0.464818763326226), (29, 0.4669509594882729), (38, 0.4690831556503198)]'
    labels_path: data/extra_libraries/Cayman_library/Cayman_library_noD.jsonl
    molecular_weight_stats:
        mean_absolute_mw_difference_best_prob: '31.949848194793184'
        mean_absolute_mw_difference_best_simil: '29.493778918563326'
        mean_relative_mw_difference_best_prob: 11.30%
        mean_relative_mw_difference_best_simil: 10.43%
        rate_of_exact_mw_prob: '0.39872068230277186'
        rate_of_exact_mw_simil: '0.5287846481876333'
        rate_of_exact_nominal_mw_prob: '0.44136460554371004'
        rate_of_exact_nominal_mw_simil: '0.5501066098081023'
        rate_of_mw_difference_less_than_1_best_prob: '0.4605543710021322'
        rate_of_mw_difference_less_than_1_best_simil: '0.5565031982942431'
    num_datapoints_tested: '469'
    num_empty_preds: '0'
    num_predictions_at_k_counter: '[469, 467, 467, 467, 467, 466, 466, 464, 462, 462,
        460, 457, 454, 451, 447, 446, 444, 442, 438, 435, 433, 428, 427, 423, 418,
        416, 415, 408, 405, 397, 389, 382, 370, 367, 357, 348, 338, 333, 321, 313,
        301, 287, 271, 247, 225, 195, 165, 136, 95, 47]'
    precise_preds_stats:
        num_precise_preds_probsort: '87'
        num_precise_preds_similsort: '218'
        rate_of_precise_preds_probsort: '0.18550106609808104'
        rate_of_precise_preds_similsort: '0.464818763326226'
    simil_1_hits:
        counter_multiple_hits: dict_items([(1, 212), (3, 2), (2, 6)])
        num_1_hits_as_first_probsort: '87'
        num_1_hits_as_first_similsort: '220'
        num_fp_simil_fail_prob: '0'
        num_fp_simil_fail_simil: '2'
        rate_of_1_hits_as_first_probsort: '0.18550106609808104'
        rate_of_1_hits_as_first_similsort: '0.4690831556503198'
    start_time_utc: 14/12/2024 17:30:20
    threshold_stats:
        num_better_than_threshold_probsort: '106'
        num_better_than_threshold_similsort: '239'
        rate_of_better_than_threshold_probsort: '0.2260127931769723'
        rate_of_better_than_threshold_similsort: '0.509594882729211'
        threshold: '0.85'
    topk_probsort: '[0.6083289440782758, 0.5406792289355601, 0.5153560575726941, 0.48177045330115104,
        0.48857860540063536, 0.4719031838526756, 0.4576236919997998, 0.4610737393525,
        0.44441657264040596, 0.43984368037812716, 0.43357383046858067, 0.4462590049299988,
        0.4315954119928563, 0.42572757696334573, 0.43052752983763176, 0.43397064437819394,
        0.42639337863320936, 0.41767958516184617, 0.4127375363720047, 0.4213763908866397,
        0.4096954704636755, 0.41301248277117203, 0.4072764181830788, 0.3980793175754518,
        0.3934880283060586, 0.3983627079391693, 0.39614966746519864, 0.4025982799215135,
        0.39920724482459147, 0.3947240375855652, 0.3930072682978055, 0.37278675179882576,
        0.37668675705779064, 0.38511628447306046, 0.3835019723787029, 0.3726453312921889,
        0.36952213075607115, 0.3654352434778579, 0.36420040060892006, 0.35866714248660436,
        0.36063180827732244, 0.35136752441773994, 0.35865309722348926, 0.35354223990102635,
        0.34872286875977376, 0.35140471789431477, 0.32524534900491203, 0.31143740447628493,
        0.3121866278134141, 0.2813837219138076]'
    topk_similsort: '[0.7801495128277657, 0.6651929753045323, 0.6165588095719797,
        0.5847381963556023, 0.5598523723599046, 0.540385252515184, 0.5253402877119993,
        0.5120279794700754, 0.4994967367442374, 0.4869028828944406, 0.4774850434858407,
        0.46929677231068095, 0.46089348008873016, 0.4525954100437137, 0.445293222806719,
        0.43763491212065564, 0.43074904844884265, 0.4238309443344969, 0.41728133092565356,
        0.40971543486506473, 0.40343974994195203, 0.3979931212303004, 0.39187162742094334,
        0.38559472702470005, 0.3797475843934606, 0.37211771974683877, 0.3646655932697151,
        0.36042867813160073, 0.35387614846426807, 0.34909899865820915, 0.34280287680160254,
        0.33783249143673216, 0.33344267712658915, 0.327246720587515, 0.32210929985855596,
        0.31515757855212456, 0.3089458272955546, 0.3010078973792362, 0.2979393468354456,
        0.29070238330583204, 0.28321080368741547, 0.2774662886955399, 0.27166192279669155,
        0.2659315394994075, 0.25775713194329225, 0.25156671681853565, 0.24026854377080697,
        0.23238950366168082, 0.22735555239721722, 0.19191352298292716]'

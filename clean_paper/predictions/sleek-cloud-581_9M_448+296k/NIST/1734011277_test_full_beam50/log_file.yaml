command: ../predict.py --checkpoint ../checkpoints/finetune_clean/sleek-cloud-581_9M_448+296k/checkpoint-294952
  --output-folder predictions --config-file configs/predict_nist_test_beam50.yaml
cuda_visible_devices: '2'
dataloader:
  batch_size: 1
  num_workers: 1
dataset:
  data_path: data/nist/test.jsonl
  data_split: test
  dataset_name: NIST
general:
  additional_naming_info: beam50
  device: cuda
generation_args:
  do_sample: false
  length_penalty: 1.0
  max_length: 200
  num_beams: 50
  num_return_sequences: 50
  penalty_alpha: null
  temperature: null
  top_k: null
  top_p: null
preprocess_args:
  inference_mode: true
  log_base: 1.28
  log_shift: 29
  max_cumsum: null
  max_mol_repr_len: 100
  max_mz: 500
  max_num_peaks: 300
  mol_repr: smiles
  restrict_intensities: false
  source_token: <nist>
start_loading_time: 12/12/2024 14:47:56
tokenizer_path: tokenizer/tokenizer_mf10M.model
finished_time_utc: 14/12/2024 18:31:01
generation_time: 03:43:01
wall_time_utc: 03:43:04
evaluation_0:
    average_num_of_predictions: '32.087664060565324'
    eval_config:
        do_db_search: false
        filtering_args:
            max_mol_repr_len: 100
            max_mz: 500
            max_num_peaks: 300
            mol_repr: smiles
        fingerprint_type: morgan
        fp_simil_function: tanimoto
        on_the_fly: true
        save_best_predictions: true
        threshold: 0.85
    eval_time: 00:03:11
    formula_stats:
        num_all_correct_formulas: 129431 / 907022
        num_at_least_one_correct_formula: '25518'
        num_correct_formulas_at_best_prob: '18223'
        num_correct_formulas_at_best_simil: '22405'
        rate_of_all_correct_formulas: '0.14269885405205165'
        rate_of_at_least_one_correct_formula: '0.9027487883397601'
        rate_of_correct_formulas_at_best_prob: '0.6446740014858315'
        rate_of_correct_formulas_at_best_simil: '0.792620370042806'
    hit_at_k_prob: '[(1, 0.38861570028655323), (2, 0.47900378533272014), (3, 0.522729684791453),
        (4, 0.5504298298369124), (5, 0.5711253405030601), (6, 0.5876463720946687),
        (7, 0.6014433792054339), (8, 0.6118088230091626), (9, 0.621502104928008),
        (10, 0.6293204089574416), (11, 0.6359712739236566), (12, 0.6425513850072523),
        (13, 0.6477517953797715), (14, 0.6521739130434783), (15, 0.6561361304701595),
        (16, 0.6603106095446988), (17, 0.6639190575582835), (18, 0.6668553436869848),
        (19, 0.6694378604025896), (20, 0.6718434924116461), (21, 0.674001485831535),
        (22, 0.6767962641949977), (23, 0.6784589804365515), (24, 0.6802278275020341),
        (25, 0.6817136590370396), (26, 0.6838008985743093), (27, 0.6852513531680051),
        (28, 0.6863834152899141), (29, 0.6871970849400361), (30, 0.6880107545901581),
        (31, 0.6887890472989705), (32, 0.6896380938904022), (33, 0.6899564863621891),
        (34, 0.6903102557752857), (35, 0.6908762868362401), (36, 0.6912300562493366),
        (37, 0.6916192026037429), (38, 0.6919022181342201), (39, 0.6921144797820781),
        (40, 0.692220610606007), (41, 0.6922913644886263), (42, 0.692432872253865),
        (43, 0.6924682491951746), (44, 0.6925743800191035), (45, 0.6926451339017229),
        (46, 0.6926805108430325), (48, 0.6927158877843421)]'
    labels_path: data/nist/test.jsonl
    molecular_weight_stats:
        mean_absolute_mw_difference_best_prob: '6.3161096117411315'
        mean_absolute_mw_difference_best_simil: '7.226685354492094'
        mean_relative_mw_difference_best_prob: 2.28%
        mean_relative_mw_difference_best_simil: 2.69%
        rate_of_exact_mw_prob: '0.632858103088407'
        rate_of_exact_mw_simil: '0.7050624403014115'
        rate_of_exact_nominal_mw_prob: '0.6790957653801253'
        rate_of_exact_nominal_mw_simil: '0.723847596136838'
        rate_of_mw_difference_less_than_1_best_prob: '0.7002157993419889'
        rate_of_mw_difference_less_than_1_best_simil: '0.7371139491279584'
    num_datapoints_tested: '28267'
    num_empty_preds: '0'
    num_predictions_at_k_counter: '[28267, 27966, 27657, 27374, 27109, 26852, 26612,
        26347, 26123, 25875, 25599, 25328, 25056, 24772, 24465, 24087, 23711, 23352,
        22933, 22535, 22075, 21611, 21131, 20610, 20136, 19611, 19072, 18513, 17974,
        17456, 16878, 16280, 15660, 15022, 14341, 13659, 12957, 12233, 11484, 10761,
        10020, 9151, 8303, 7376, 6413, 5435, 4385, 3285, 2138, 1032]'
    precise_preds_stats:
        num_precise_preds_probsort: '10393'
        num_precise_preds_similsort: '19498'
        rate_of_precise_preds_probsort: '0.36767255103123786'
        rate_of_precise_preds_similsort: '0.6897796016556409'
    simil_1_hits:
        counter_multiple_hits: dict_items([(1, 16324), (2, 1110), (5, 216), (3, 1209),
            (4, 472), (6, 109), (7, 60), (8, 39), (10, 7), (23, 2), (12, 3), (21,
            1), (20, 1), (14, 2), (9, 17), (17, 1), (15, 1), (13, 2), (11, 2), (22,
            1), (26, 1), (19, 1)])
        num_1_hits_as_first_probsort: '10985'
        num_1_hits_as_first_similsort: '19581'
        num_fp_simil_fail_prob: '592'
        num_fp_simil_fail_simil: '83'
        rate_of_1_hits_as_first_probsort: '0.38861570028655323'
        rate_of_1_hits_as_first_similsort: '0.6927158877843421'
    start_time_utc: 14/12/2024 19:52:44
    threshold_stats:
        num_better_than_threshold_probsort: '11333'
        num_better_than_threshold_similsort: '19768'
        rate_of_better_than_threshold_probsort: '0.40092687586231296'
        rate_of_better_than_threshold_similsort: '0.6993313758092475'
        threshold: '0.85'
    topk_probsort: '[0.6501336073290572, 0.5299032382069118, 0.48367244372551166,
        0.4579521239302835, 0.4433862492422021, 0.43157540951504303, 0.42338708828283883,
        0.4159104355804434, 0.4112155607673508, 0.4061129735624985, 0.40106641827245315,
        0.3975524827241244, 0.39469541889245735, 0.3896577757481386, 0.38704242059652416,
        0.3855372758335573, 0.3810086767006234, 0.378205973043697, 0.37370244765143995,
        0.3705248645053618, 0.3650657065035398, 0.36345486993119525, 0.35799998528204874,
        0.35401762333393244, 0.34927225449320465, 0.34756728099210754, 0.34110222756745573,
        0.3391541090909279, 0.33348796386793383, 0.3304774498577515, 0.3265081673826362,
        0.3225101122503875, 0.3167496339937113, 0.31412954453324615, 0.31020940370882427,
        0.30535159418417945, 0.30235973100289076, 0.2965562663871163, 0.29271734949851735,
        0.28967903485024116, 0.2850372796722583, 0.28099237202943517, 0.2770619574736236,
        0.2715119992648255, 0.26486830701027064, 0.2626579576317211, 0.2587520850876879,
        0.2535351670632719, 0.2459315826093158, 0.24475876777239444]'
    topk_similsort: '[0.8397492428499629, 0.6468211835103672, 0.5854987581513126,
        0.5447862727030653, 0.5161547479244115, 0.49396890576435465, 0.47589744675973883,
        0.4604992955701306, 0.44687991415150796, 0.43493530692664484, 0.42398200181148316,
        0.4138401764066442, 0.4041887051091743, 0.3951296310150002, 0.38654210823319046,
        0.37830576032727786, 0.3702041515311361, 0.3619330366785249, 0.3545221785722595,
        0.34655098734021694, 0.3386099400138291, 0.331394249464236, 0.3241228944878295,
        0.3172433044563227, 0.3101805236575819, 0.303539040789762, 0.2971154613844126,
        0.2906675959201591, 0.28429050784573306, 0.27785569852503833, 0.2713881631289057,
        0.26494853537999846, 0.25857727768953426, 0.25266443966223656, 0.24665326424664033,
        0.24070479344493093, 0.23493487465210303, 0.22882087803396997, 0.22274098815241541,
        0.2173912019956721, 0.21157121281309918, 0.20552395198303672, 0.19935226579682355,
        0.19318770889858064, 0.1862165476502726, 0.1793174972849377, 0.17306166375960363,
        0.16469643746368084, 0.1557071807317871, 0.14566767863604904]'
